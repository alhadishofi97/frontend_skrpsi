import{au as f,e as a,U as y,j as e,G as t,av as v,aw as S,ax as m,T as b,S as x,J as w,H as I}from"./index-Bg9J7LGO.js";import{A as C,a as k,b as A}from"./AuthFooter-CpcvmirR.js";import{A as L}from"./Alert-B31wvcm5.js";const D="https://backendapi.my.id",W=()=>{const h=f(r=>r.breakpoints.down("md")),[o,g]=a.useState(""),[l,j]=a.useState(""),[c,n]=a.useState(null),u=y();a.useEffect(()=>{localStorage.getItem("token")&&u("/dashboard/default",{replace:!0})},[]);const p=async r=>{r.preventDefault(),n(null);const d={username:o,password:l};try{const i=await fetch(D+"/api/users/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)}),s=await i.json();i.ok&&s.status==="success"?(localStorage.setItem("token",s.token),localStorage.setItem("menu-items",JSON.stringify(s.authority)),localStorage.setItem("username",d.username),localStorage.setItem("name",s.name),localStorage.setItem("id_user",s.id_user),u("/dashboard/default",{replace:!0})):n(s.data||"Username atau password salah")}catch{n("An error occurred while logging in.")}};return e.jsx(C,{children:e.jsxs(t,{container:!0,direction:"column",justifyContent:"flex-end",sx:{minHeight:"100vh"},children:[e.jsx(t,{item:!0,xs:12,children:e.jsx(t,{container:!0,justifyContent:"center",alignItems:"center",sx:{minHeight:"calc(100vh - 68px)"},children:e.jsx(t,{item:!0,sx:{m:{xs:1,sm:3},mb:0},children:e.jsx(k,{children:e.jsxs(t,{container:!0,spacing:2,alignItems:"center",justifyContent:"center",children:[e.jsx(t,{item:!0,sx:{mb:3},children:e.jsx(v,{to:"#","aria-label":"logo",children:e.jsx(S,{})})}),e.jsx(t,{item:!0,xs:12,children:e.jsx(t,{container:!0,direction:{xs:"column-reverse",md:"row"},alignItems:"center",justifyContent:"center",children:e.jsx(t,{item:!0,children:e.jsx(m,{alignItems:"center",justifyContent:"center",spacing:1,children:e.jsx(b,{color:"secondary.main",gutterBottom:!0,variant:h?"h3":"h2",children:"Hi, Selamat Datang"})})})})}),e.jsx(t,{item:!0,xs:12,children:e.jsx("form",{onSubmit:p,children:e.jsxs(m,{spacing:2,children:[e.jsx(x,{label:"Username",variant:"outlined",fullWidth:!0,value:o,onChange:r=>g(r.target.value)}),e.jsx(x,{label:"Password",type:"password",variant:"outlined",fullWidth:!0,value:l,onChange:r=>j(r.target.value)}),c&&e.jsx(L,{severity:"error",children:c}),e.jsx(w,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,size:"large",children:"Login"})]})})}),e.jsx(t,{item:!0,xs:12,children:e.jsx(I,{})}),e.jsx(t,{item:!0,xs:12,children:e.jsx(t,{item:!0,container:!0,direction:"column",alignItems:"center",xs:12})})]})})})})}),e.jsx(t,{item:!0,xs:12,sx:{m:3,mt:1},children:e.jsx(A,{})})]})})};export{W as Login,W as default};
